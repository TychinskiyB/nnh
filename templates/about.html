{% extends "base.html" %}
{% block title %}–û –∫–æ–º–ø–∞–Ω–∏–∏ ‚Äî –ù–û–í–û–ù–ï–§–¢–ï–•–ò–ú{% endblock %}

{% block content %}

<style>
  .about-page {
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
  }
  
  /* –£–ü–†–û–©–ï–ù–ù–´–ô –°–¢–ò–õ–¨ –î–õ–Ø –ì–ï–†–û–Ø –ë–ï–ó –†–ê–ú–ö–ò */
  .hero-framed {
    padding: 80px 0 60px;
    background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
    text-align: center;
    position: relative;
  }
  
  .hero-framed-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    background: #ffffff;
  }
  
  .hero-framed h1 {
    font-size: 48px;
    font-weight: 700;
    color: #1d1d1f;
    margin-bottom: 16px;
    letter-spacing: -0.5px;
  }
  
  .hero-framed .lead {
    font-size: 24px;
    color: #515154;
    line-height: 1.4;
    margin-bottom: 40px;
    font-weight: 400;
  }
  
  .image-plain {
    max-width: 1000px;
    margin: 0 auto;
  }
  
  .image-plain img {
    width: 100%;
    height: auto;
    border-radius: 12px;
    display: block;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }
  
  .about-page .team-photo{
    height: auto !important;
    aspect-ratio: 4 / 3;
    overflow: hidden;
    border-radius: 12px;
  }
  .about-page .team-photo img{
    width: 100%; height: 100%;
    object-fit: cover; object-position: center;
    display: block;
    transition: transform 0.3s ease;
  }

  .about-page #team-grid{
    display: grid;
    gap: 24px;
    grid-template-columns: repeat(4, 1fr);
    justify-content: center;
    align-items: start;
    max-width: 1200px;
    margin: 0 auto;
  }
  .about-page #team-grid .span-2{ grid-column: span 2; }

  @media (max-width: 1024px){
    .about-page #team-grid{
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 560px){
    .about-page #team-grid{
      grid-template-columns: 1fr;
      gap: 16px;
    }
    .about-page #team-grid .span-2{ grid-column: span 1; }
    
    .hero-framed h1 {
      font-size: 36px;
    }
    
    .hero-framed .lead {
      font-size: 20px;
    }
  }

  .about-page .hero-dark .lead {
    color: inherit;
    text-shadow: inherit;
    font-size: 21px;
    line-height: 1.381;
    font-weight: 400;
  }

  .about-section {
    padding: 80px 0;
  }

  .section-head {
    margin-bottom: 60px;
    text-align: center;
  }

  .section-head h2 {
    font-size: 40px;
    font-weight: 600;
    margin-bottom: 16px;
    color: #1d1d1f;
    letter-spacing: -0.5px;
  }

  .section-head p {
    font-size: 21px;
    line-height: 1.381;
    color: #86868b;
    max-width: 600px;
    margin: 0 auto;
  }

  .apple-timeline {
    max-width: 800px;
    margin: 0 auto;
    position: relative;
  }

  .apple-timeline::before {
    content: '';
    position: absolute;
    left: 20px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #f5f5f7;
    z-index: 1;
  }

  .apple-timeline li {
    position: relative;
    margin-bottom: 48px;
    list-style: none;
    padding-left: 60px;
  }

  .apple-timeline li:last-child {
    margin-bottom: 0;
  }

  .tl-dot {
    position: absolute;
    left: 12px;
    top: 8px;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: #8B7355;
    border: 4px solid white;
    box-shadow: 0 0 0 2px #8B7355;
    z-index: 2;
  }

  .tl-content {
    background: white;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .tl-content:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .tl-content h3 {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 12px;
    color: #1d1d1f;
  }

  .tl-content p {
    font-size: 17px;
    line-height: 1.47059;
    color: #515154;
    margin: 0;
  }

  .apple-chips {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 40px;
    flex-wrap: wrap;
  }

  .apple-chip {
    padding: 8px 20px;
    background: #f5f5f7;
    border: none;
    border-radius: 20px;
    font-size: 15px;
    font-weight: 500;
    color: #515154;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .apple-chip.active,
  .apple-chip:hover {
    background: #8B7355;
    color: white;
  }

  .apple-team-card {
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .apple-team-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .apple-team-card:hover .team-photo img {
    transform: scale(1.05);
  }

  .team-body {
    padding: 24px;
  }

  .team-body h3 {
    font-size: 19px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1d1d1f;
  }

  .role {
    font-size: 15px;
    color: #86868b;
    margin: 0;
    line-height: 1.47059;
  }

  /* –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ú–û–î–ê–õ–ö–ê */
  .apple-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
    box-sizing: border-box;
  }

  .apple-modal.active {
    display: flex;
  }

  .modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(8px);
  }

  .apple-modal-dialog {
    position: relative;
    background: white;
    border-radius: 20px;
    max-width: 500px;
    width: 100%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
    animation: modalAppear 0.4s ease;
    overflow: hidden;
    max-height: 90vh;
    overflow-y: auto;
  }

  @keyframes modalAppear {
    from {
      opacity: 0;
      transform: scale(0.9) translateY(20px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  .apple-modal-close {
    position: absolute;
    top: 16px;
    right: 16px;
    width: 32px;
    height: 32px;
    border: none;
    background: #f5f5f7;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    z-index: 1;
    transition: background 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .apple-modal-close:hover {
    background: #e5e5e7;
  }

  .apple-modal-content {
    padding: 32px;
  }

  .emp-header {
    display: flex;
    gap: 20px;
    align-items: center;
    margin-bottom: 24px;
  }

  .emp-photo {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    object-fit: cover;
  }

  .emp-header h3 {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 4px;
    color: #1d1d1f;
  }

  .emp-header .muted {
    font-size: 17px;
    color: #86868b;
    margin: 0;
  }

  .contact-info p {
    font-size: 17px;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .contact-info strong {
    min-width: 80px;
    color: #1d1d1f;
  }

  .contact-info a {
    color: #007AFF;
    text-decoration: none;
  }

  .contact-info a:hover {
    text-decoration: underline;
  }

  .reveal {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.6s ease;
  }

  .reveal.reveal-in {
    opacity: 1;
    transform: translateY(0);
  }

  @media (max-width: 768px) {
    .about-section {
      padding: 60px 0;
    }
    
    .section-head h2 {
      font-size: 32px;
    }
    
    .section-head p {
      font-size: 19px;
    }
    
    .apple-timeline::before {
      left: 16px;
    }
    
    .apple-timeline li {
      padding-left: 48px;
    }
    
    .tl-dot {
      left: 8px;
    }
    
    .emp-header {
      flex-direction: column;
      text-align: center;
    }
    
    .apple-modal-dialog {
      margin: 20px;
    }
    
    .apple-modal-content {
      padding: 24px;
    }
  }
</style>

<div class="about-page">

  <!-- –£–ü–†–û–©–ï–ù–ù–´–ô –ì–ï–†–û–ô –ë–ï–ó –†–ê–ú–ö–ò –ò –ö–ù–û–ü–û–ö -->
  <section class="hero-framed reveal">
    <div class="hero-framed-content">
      <h1>–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</h1>

      
      <div class="image-plain">
        <img src="{{ url_for('static', filename='images/slide10.png') }}" 
             alt="–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞" />
      </div>
    </div>
  </section>

  <!-- –ö–ª—é—á–µ–≤—ã–µ –≤–µ—Ö–∏ -->
  <section class="about-section">
   <div class="container">
     <div class="section-head center reveal">
       <h2>–ö–ª—é—á–µ–≤—ã–µ –≤–µ—Ö–∏</h2>
       <p>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</p>
     </div>

     <ol class="apple-timeline">
       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2013</h3>
           <p>üìç 16 –∞–≤–≥—É—Å—Ç–∞ –≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è, —Å—Ç–∞–≤—à–∞—è –æ—Å–Ω–æ–≤–æ–π –±—É–¥—É—â–µ–≥–æ –ù–û–í–û–ù–ï–§–¢–ï–•–ò–ú–∞.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2014</h3>
           <p>–í —è–Ω–≤–∞—Ä–µ –ò–≤–∞–Ω –õ–µ—â–∏–Ω—Å–∫–∏–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —É—á—Ä–µ–¥–∏—Ç–µ–ª–µ–º. –ö–æ–º–ø–∞–Ω–∏—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2014‚Äì2016</h3>
           <p>–ü–µ—Ä–∏–æ–¥ —Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –Ω–µ–±–æ–ª—å—à–∏–º–∏, –Ω–æ –∑–Ω–∞—á–∏–º—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2016</h3>
           <p>üî• –ü–µ—Ä–≤—ã–µ –∫—Ä—É–ø–Ω—ã–µ –ø–∞—Ä—Ç–Ω—ë—Ä—ã: –†–æ—Å–Ω–µ—Ñ—Ç—å, –ì–∞–∑–ø—Ä–æ–º–Ω–µ—Ñ—Ç—å, –°–∏–±—É—Ä, –ï–≤—Ä–∞–∑.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2018</h3>
           <p>üí™ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–∞—Å—à—Ç–∞–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –û–ù–ü–ó ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–µ–∑–≤–æ–∂–∏–≤–∞–Ω–∏—è —à–ª–∞–º–∞.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2022</h3>
           <p>üè∑Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–¥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –±—Ä–µ–Ω–¥–æ–º.</p>
         </div>
       </li>

       <li class="reveal">
         <div class="tl-dot"></div>
         <div class="tl-content">
           <h3>2025</h3>
           <p>üöÄ –°—Ç–∞—Ä—Ç –º–∞—Å—à—Ç–∞–±–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞.</p>
         </div>
       </li>
     </ol>
   </div>
  </section>

  <!-- –ö–æ–º–∞–Ω–¥–∞ -->
  <section class="about-section" style="background: #fbfbfd;">
   <div class="container">
     <div class="section-head center reveal">
       <h2>–ö–æ–º–∞–Ω–¥–∞</h2>
       <p>–ö—Ä–æ—Å—Å-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤, –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</p>
     </div>

     <div class="apple-chips" id="dept-filters" {% if not depts %}hidden{% endif %}>
       <button class="apple-chip active" data-dept="__all__">–í—Å–µ</button>
       {% for d in depts %}
         {% set d_norm = (d or '')|trim|lower %}
         <button class="apple-chip" data-dept="{{ d_norm|e }}">{{ d }}</button>
       {% endfor %}
     </div>

     <div class="team-mosaic" id="team-grid">
       {% for e in employees %}
         {% set dept_norm = (e.dept or '')|trim|lower %}
         <article class="apple-team-card {% if e.span2 %}span-2{% endif %} reveal"
                  data-dept="{{ dept_norm|e }}"
                  data-name="{{ e.full_name|e }}"
                  data-title="{{ e.title|e }}"
                  data-email="{{ (e.email or '')|e }}"
                  data-phone="{{ (e.phone or '')|e }}"
                  data-photo="{{ (e.photo if e.photo and (e.photo.startswith('http') or e.photo.startswith('/static/')) else ('/' ~ (e.photo or ''))) | e }}">
           <div class="team-photo">
             {% if e.photo %}
               <img src="{{ e.photo if e.photo.startswith('http') or e.photo.startswith('/static/') else '/' ~ e.photo }}"
                    alt="{{ e.full_name|e }}">
             {% else %}
               <img src="{{ url_for('static', filename='images/placeholder_user.jpg') }}"
                    alt="{{ e.full_name|e }}">
             {% endif %}
           </div>
           <div class="team-body">
             <h3>{{ e.full_name }}</h3>
             <p class="role">{{ e.title }} ‚Äî {{ e.dept }}</p>
           </div>
         </article>
       {% else %}
         <p class="muted center" style="grid-column: 1 / -1;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>
       {% endfor %}
     </div>
   </div>
  </section>

  <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ú–û–î–ê–õ–ö–ê -->
  <div class="apple-modal" id="empModal">
    <div class="modal-backdrop" data-close></div>
    <div class="apple-modal-dialog" role="dialog" aria-labelledby="empName">
      <button class="apple-modal-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å" data-close>√ó</button>
      <div class="apple-modal-content">
        <div class="emp-header">
          <img id="empPhoto" class="emp-photo" src="" alt="" />
          <div>
            <h3 id="empName"></h3>
            <p class="muted" id="empDeptTitle"></p>
          </div>
        </div>
        <div class="contact-info">
          <p><strong>–ü–æ—á—Ç–∞:</strong> <a id="empEmail" href="#"></a></p>
          <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="empPhone">‚Äî</span></p>
        </div>
      </div>
    </div>
  </div>

</div>

{% endblock %}

{% block body_end %}
<script>
// Scroll reveal –∞–Ω–∏–º–∞—Ü–∏—è
(() => {
  const els = [...document.querySelectorAll('.reveal')];
  if(!els.length) return;
  
  const io = new IntersectionObserver(es => {
    es.forEach(en => {
      if(en.isIntersecting) {
        en.target.classList.add('reveal-in');
        io.unobserve(en.target);
      }
    });
  }, { threshold: 0.18 });
  
  els.forEach(el => io.observe(el));
})();

/* –§–∏–ª—å—Ç—Ä—ã –æ—Ç–¥–µ–ª–æ–≤ */
(function () {
  const bar  = document.getElementById('dept-filters');
  const grid = document.getElementById('team-grid');
  if (!grid) return;

  const cards = Array.from(grid.querySelectorAll('.apple-team-card'));
  const norm = s => (s || '').toString().trim().toLowerCase();

  function apply(dept) {
    const wantAll = (dept === '__all__');
    cards.forEach(c => {
      const cd = norm(c.dataset.dept);
      const show = wantAll || cd === dept;
      c.style.display = show ? 'block' : 'none';
    });
  }

  if (bar && bar.hidden !== true) {
    const chips = Array.from(bar.querySelectorAll('.apple-chip'));
    bar.addEventListener('click', e => {
      const btn = e.target.closest('.apple-chip'); 
      if (!btn) return;
      
      chips.forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      apply(btn.dataset.dept);
    });
  }
})();

/* –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ú–û–î–ê–õ–ö–ê –°–û–¢–†–£–î–ù–ò–ö–ê */
(function () {
  const grid = document.getElementById('team-grid');
  const modal = document.getElementById('empModal');
  
  if (!grid || !modal) return;

  const nameEl = document.getElementById('empName');
  const dtEl = document.getElementById('empDeptTitle');
  const emailEl = document.getElementById('empEmail');
  const phoneEl = document.getElementById('empPhone');
  const photoEl = document.getElementById('empPhoto'); // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–†–û–ö–ê

  // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏
  function openModal(card) {
    const name = card.dataset.name || '';
    const title = card.dataset.title || '';
    const dept = card.dataset.dept || '';
    const email = card.dataset.email || '';
    const phone = card.dataset.phone || '';
    const photo = card.dataset.photo || '';

    // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
    nameEl.textContent = name;
    dtEl.textContent = [title, dept].filter(Boolean).join(' ‚Äî ');
    emailEl.textContent = email || '‚Äî';
    emailEl.href = email ? 'mailto:' + email : '#';
    phoneEl.textContent = phone || '‚Äî';

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ç–æ
    if (photo && photo !== '/') {
      photoEl.src = photo;
      photoEl.alt = name;
      photoEl.style.display = 'block';
    } else {
      photoEl.src = '{{ url_for("static", filename="images/placeholder_user.jpg") }}';
      photoEl.alt = name;
      photoEl.style.display = 'block';
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏
  function closeModal() {
    modal.classList.remove('active');
    document.body.style.overflow = '';
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
  grid.addEventListener('click', (e) => {
    const card = e.target.closest('.apple-team-card');
    if (card) {
      openModal(card);
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏
  modal.addEventListener('click', (e) => {
    if (e.target.classList.contains('modal-backdrop') || 
        e.target.classList.contains('apple-modal-close') ||
        e.target.hasAttribute('data-close')) {
      closeModal();
    }
  });

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal.classList.contains('active')) {
      closeModal();
    }
  });
})();
</script>
{% endblock %}